@* @model IEnumerable<AutomatedExamSystem.Models.Question>

<div class="container mt-4">
    <h2 class="text-center mb-3">Your Test — 60 Minutes</h2>
    <div id="timer" class="text-center fw-bold fs-4 text-danger mb-4">60:00</div>

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-warning alert-dismissible fade show text-center" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <form id="examForm" asp-action="Submit" method="post">
        @Html.AntiForgeryToken()

        @foreach (var q in Model.Select((val, idx) => new { val, idx }))
        {
            <div class="card mb-3 shadow-sm">
                <div class="card-body">
                    <p class="fw-bold">@(q.idx + 1). @q.val.QuestionText</p>
                    <div class="ms-3">
                        <div><input type="radio" name="answers[@q.val.Id]" value="A" /> @q.val.OptionA</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="B" /> @q.val.OptionB</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="C" /> @q.val.OptionC</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="D" /> @q.val.OptionD</div>
                    </div>
                </div>
            </div>
        }

        <div class="text-center mt-4">
            <button type="button" id="submitBtn" class="btn btn-success btn-lg">
                Submit
            </button>
        </div>
    </form>
</div>

<!-- Confirmation Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-warning">
                <h5 class="modal-title">Confirm Submission</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to submit your test? Once submitted, you cannot change your answers.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" id="confirmSubmit" class="btn btn-success">Yes, Submit</button>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        // Countdown timer (60 minutes)
        let total = 60 * 60;
        const timerEl = document.getElementById('timer');
        const interval = setInterval(() => {
            total--;
            const mm = Math.floor(total / 60).toString().padStart(2, '0');
            const ss = (total % 60).toString().padStart(2, '0');
            timerEl.textContent = `${mm}:${ss}`;
            if (total <= 0) {
                clearInterval(interval);
                alert('Time is up — submitting...');
                document.getElementById('examForm').submit();
            }
        }, 1000);

        // Confirmation modal before submit
        const submitBtn = document.getElementById('submitBtn');
        const confirmSubmit = document.getElementById('confirmSubmit');
        const examForm = document.getElementById('examForm');

        submitBtn.addEventListener('click', () => {
            const selected = document.querySelectorAll('input[type="radio"]:checked');
            if (selected.length === 0) {
                alert('⚠️ Please select at least one answer before submitting.');
                return;
            }
            const modal = new bootstrap.Modal(document.getElementById('confirmModal'));
            modal.show();
        });

        confirmSubmit.addEventListener('click', () => {
            const modal = bootstrap.Modal.getInstance(document.getElementById('confirmModal'));
            modal.hide();
            examForm.submit();
        });
    </script>
}

 *@













                @* @model IEnumerable<AutomatedExamSystem.Models.Question>
@{
    ViewData["Title"] = "Your Exam";
}

<div class="container mt-4">
    <h2 class="text-center mb-3">Your Test — 60 Minutes</h2>
    <div id="timer" class="text-center fw-bold fs-4 text-danger mb-4">60:00</div>

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-warning alert-dismissible fade show text-center" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <form id="examForm" asp-action="Submit" method="post">
        @Html.AntiForgeryToken()

        @foreach (var q in Model.Select((val, idx) => new { val, idx }))
        {
            <div class="card mb-3 shadow-sm">
                <div class="card-body">
                    <p class="fw-bold">@(q.idx + 1). @q.val.QuestionText</p>
                    <div class="ms-3">
                        <div><input type="radio" name="answers[@q.val.Id]" value="A" /> @q.val.OptionA</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="B" /> @q.val.OptionB</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="C" /> @q.val.OptionC</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="D" /> @q.val.OptionD</div>
                    </div>
                </div>
            </div>
        }

        <div class="text-center mt-4">
            <button type="button" id="submitBtn" class="btn btn-success btn-lg">
                Submit
            </button>
        </div>
    </form>
</div>

<!-- ✅ Confirmation Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-warning">
                <h5 class="modal-title">Confirm Submission</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to submit your test? Once submitted, you cannot change your answers.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" id="confirmSubmit" class="btn btn-success">Yes, Submit</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // ✅ Countdown timer (60 minutes)
        let total = 60 * 60; // seconds
        const timerEl = document.getElementById('timer');

        const interval = setInterval(() => {
            total--;
            const mm = Math.floor(total / 60).toString().padStart(2, '0');
            const ss = (total % 60).toString().padStart(2, '0');
            timerEl.textContent = `${mm}:${ss}`;

            if (total <= 0) {
                clearInterval(interval);
                alert('⏰ Time is up! Submitting automatically...');
                document.getElementById('examForm').submit();
            }
        }, 1000);

        // ✅ Confirm modal logic
        const submitBtn = document.getElementById('submitBtn');
        const confirmSubmit = document.getElementById('confirmSubmit');
        const examForm = document.getElementById('examForm');

        submitBtn.addEventListener('click', () => {
            const selected = document.querySelectorAll('input[type="radio"]:checked');
            if (selected.length === 0) {
                alert('⚠️ Please select at least one answer before submitting.');
                return;
            }
            const modal = new bootstrap.Modal(document.getElementById('confirmModal'));
            modal.show();
        });

        confirmSubmit.addEventListener('click', () => {
            const modal = bootstrap.Modal.getInstance(document.getElementById('confirmModal'));
            modal.hide();
            examForm.submit();
        });
    </script>
}
 *@





                @model IEnumerable<AutomatedExamSystem.Models.Question>
@{
    ViewData["Title"] = "Your Exam";
}

<div class="container mt-4">
    <h2 class="text-center mb-3">Your Test — 50 Minutes</h2>
    <div id="timer" class="text-center fw-bold fs-4 text-danger mb-4">50:00</div>

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-warning alert-dismissible fade show text-center" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <form id="examForm" asp-action="Submit" method="post">
        @Html.AntiForgeryToken()

        @foreach (var q in Model.Select((val, idx) => new { val, idx }))
        {
            <div class="card mb-3 shadow-sm">
                <div class="card-body">
                    <p class="fw-bold">@(q.idx + 1). @q.val.QuestionText</p>
                    <div class="ms-3">
                        <div><input type="radio" name="answers[@q.val.Id]" value="A" /> @q.val.OptionA</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="B" /> @q.val.OptionB</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="C" /> @q.val.OptionC</div>
                        <div><input type="radio" name="answers[@q.val.Id]" value="D" /> @q.val.OptionD</div>
                    </div>
                </div>
            </div>
        }

        <div class="text-center mt-4">
            <button type="button" id="submitBtn" class="btn btn-success btn-lg">
                Submit
            </button>
        </div>
    </form>
</div>

<!-- ✅ Confirmation Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-warning">
                <h5 class="modal-title">Confirm Submission</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to submit your test? Once submitted, you cannot change your answers.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" id="confirmSubmit" class="btn btn-success">Yes, Submit</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // ✅ Countdown timer (50 minutes)
        let total = 50 * 60; // seconds
        const timerEl = document.getElementById('timer');

        const interval = setInterval(() => {
            total--;
            const mm = Math.floor(total / 60).toString().padStart(2, '0');
            const ss = (total % 60).toString().padStart(2, '0');
            timerEl.textContent = `${mm}:${ss}`;

            if (total <= 0) {
                clearInterval(interval);
                alert('⏰ Time is up! Submitting automatically...');
                document.getElementById('examForm').submit();
            }
        }, 1000);

        // ✅ Confirm modal logic
        const submitBtn = document.getElementById('submitBtn');
        const confirmSubmit = document.getElementById('confirmSubmit');
        const examForm = document.getElementById('examForm');

        submitBtn.addEventListener('click', () => {
            const selected = document.querySelectorAll('input[type="radio"]:checked');
            if (selected.length === 0) {
                alert('⚠️ Please select at least one answer before submitting.');
                return;
            }
            const modal = new bootstrap.Modal(document.getElementById('confirmModal'));
            modal.show();
        });

        confirmSubmit.addEventListener('click', () => {
            const modal = bootstrap.Modal.getInstance(document.getElementById('confirmModal'));
            modal.hide();
            examForm.submit();
        });
    </script>
}
