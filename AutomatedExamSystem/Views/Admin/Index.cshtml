@model IEnumerable<AutomatedExamSystem.Models.Question>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Questions</h2>

    <form asp-action="DownloadCandidateScoresFiltered" method="get" class="d-flex gap-2 align-items-center">
        <select name="level" class="form-select">
            <option value="">All Levels</option>
            <option value="100L">100L</option>
            <option value="200L">200L</option>
            <option value="300L">300L</option>
            <option value="400L">400L</option>
        </select>

        <input type="date" name="fromDate" class="form-control" />
        <input type="date" name="toDate" class="form-control" />

        <!-- ✅ PDF Download Button -->
        <button type="submit" name="format" value="pdf" class="btn btn-outline-primary">
            <i class="bi bi-file-earmark-pdf"></i> Download PDF
        </button>

        <!-- ✅ CSV Download Button -->
        <button type="submit" name="format" value="csv" class="btn btn-outline-success">
            <i class="bi bi-filetype-csv"></i> Download CSV
        </button>
    </form>
</div>

<!-- ✅ Filter Summary Message -->
@if (!string.IsNullOrEmpty(ViewBag.Level) || !string.IsNullOrEmpty(ViewBag.FromDate) || !string.IsNullOrEmpty(ViewBag.ToDate))
{
    <div class="alert alert-info text-center shadow-sm">
        📅
        @if (!string.IsNullOrEmpty(ViewBag.Level))
        {
            <span><strong>Level:</strong> @ViewBag.Level</span>
        }

        @if (!string.IsNullOrEmpty(ViewBag.FromDate) && !string.IsNullOrEmpty(ViewBag.ToDate))
        {
            <span> | Showing results from <strong>@ViewBag.FromDate</strong> to <strong>@ViewBag.ToDate</strong></span>
        }
        else if (!string.IsNullOrEmpty(ViewBag.FromDate))
        {
            <span> | Showing results from <strong>@ViewBag.FromDate</strong> onward</span>
        }
        else if (!string.IsNullOrEmpty(ViewBag.ToDate))
        {
            <span> | Showing results up to <strong>@ViewBag.ToDate</strong></span>
        }
    </div>
}

<p>
    <a class="btn btn-success" asp-action="Create">
        <i class="bi bi-plus-circle"></i> Add Question
    </a>
</p>

<table class="table table-striped table-hover shadow-sm">
    <thead class="table-light">
        <tr>
            <th>#</th>
            <th>Section</th>
            <th>Text</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var q in Model)
        {
            <tr>
                <td>@q.Id</td>
                <td>@q.Section</td>
                <td>@q.QuestionText</td>
                <td>
                    <a class="btn btn-sm btn-primary" asp-action="Edit" asp-route-id="@q.Id">
                        <i class="bi bi-pencil-square"></i> Edit
                    </a>

                    <form asp-action="Delete" method="post" class="d-inline">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="id" value="@q.Id" />
                        <button type="submit" class="btn btn-sm btn-danger">
                            <i class="bi bi-trash"></i> Delete
                        </button>
                    </form>
                </td>
            </tr>
        }
    </tbody>
</table>